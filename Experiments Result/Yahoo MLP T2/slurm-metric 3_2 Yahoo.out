/home/amir.reza/counterfactual/CFX-REC/code/recommenders_architecture.py:41: UserWarning: The use of `x.T` on tensors of dimension other than 2 to reverse their shape is deprecated and it will throw an error in a future release. Consider `x.mT` to transpose batches of matrices or `x.permute(*torch.arange(x.ndim - 1, -1, -1))` to reverse the dimensions of a tensor. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3675.)
  output = torch.matmul(user_vec, item_vec.T).to(self.device)
0
500
1000
1500
2000
2500
 ============ Start explaining Yahoo MLP by lxr ============
From file: MLP_lxr_expl_dict.pkl
User 0, total time: 1.09
User 500, total time: 1.04
User 1000, total time: 1.06
User 1500, total time: 1.08
User 2000, total time: 1.06
User 2500, total time: 1.08
this experiment is for /home/amir.reza/counterfactual/CFX-REC/checkpoints/3MLP_Yahoo_3_256.pt and MLP
users_DEL_lxr:  0.649711404646359
users_INS_lxr:  0.7765388698058207
NDCG_lxr:  0.5523629580817047
POS_at_1_lxr:  0.336429512516469
POS_at_5_lxr:  0.5764163372859026
POS_at_10_lxr:  0.679973649538867
POS_at_20_lxr:  0.7401515151515151
POS_at_50_lxr:  0.8085638998682476
POS_at_100_lxr:  0.8854084321475625
NEG_at_1_lxr:  0.4990447957839262
NEG_at_5_lxr:  0.7244729907773386
NEG_at_10_lxr:  0.7964426877470355
NEG_at_20_lxr:  0.8263504611330698
NEG_at_50_lxr:  0.8588932806324111
NEG_at_100_lxr:  0.919828722002635
0.649711404646359 0.7765388698058207 0.5523629580817047 0.336429512516469 0.4990447957839262 0.5764163372859026 0.7244729907773386 0.679973649538867 0.7964426877470355 0.7401515151515151 0.8263504611330698 0.8085638998682476 0.8588932806324111 0.8854084321475625 0.919828722002635
 ============ Start explaining Yahoo MLP by lime ============
From file: MLP_lime_expl_dict.pkl
User 0, total time: 1.02
User 500, total time: 1.03
User 1000, total time: 1.04
User 1500, total time: 1.01
User 2000, total time: 1.05
User 2500, total time: 1.06
this experiment is for /home/amir.reza/counterfactual/CFX-REC/checkpoints/3MLP_Yahoo_3_256.pt and MLP
users_DEL_lime:  0.6151710990840972
users_INS_lime:  0.7985007127292936
NDCG_lime:  0.49057081134103936
POS_at_1_lime:  0.2680830039525692
POS_at_5_lime:  0.497562582345191
POS_at_10_lime:  0.604578392621871
POS_at_20_lime:  0.672364953886693
POS_at_50_lime:  0.7594202898550725
POS_at_100_lime:  0.8511857707509882
NEG_at_1_lime:  0.5788866930171278
NEG_at_5_lime:  0.7751646903820817
NEG_at_10_lime:  0.8325428194993413
NEG_at_20_lime:  0.8513833992094862
NEG_at_50_lime:  0.875395256916996
NEG_at_100_lime:  0.9304347826086956
0.6151710990840972 0.7985007127292936 0.49057081134103936 0.2680830039525692 0.5788866930171278 0.497562582345191 0.7751646903820817 0.604578392621871 0.8325428194993413 0.672364953886693 0.8513833992094862 0.7594202898550725 0.875395256916996 0.8511857707509882 0.9304347826086956
 ============ Start explaining Yahoo MLP by jaccard ============
From file: MLP_jaccard_expl_dict.pkl
User 0, total time: 1.04
User 500, total time: 1.05
User 1000, total time: 1.06
User 1500, total time: 1.07
User 2000, total time: 1.02
User 2500, total time: 1.03
this experiment is for /home/amir.reza/counterfactual/CFX-REC/checkpoints/3MLP_Yahoo_3_256.pt and MLP
users_DEL_jaccard:  0.6320210024793806
users_INS_jaccard:  0.785546004916486
NDCG_jaccard:  0.503555091304339
POS_at_1_jaccard:  0.2812582345191041
POS_at_5_jaccard:  0.5190711462450593
POS_at_10_jaccard:  0.6234189723320158
POS_at_20_jaccard:  0.6878458498023715
POS_at_50_jaccard:  0.7649209486166008
POS_at_100_jaccard:  0.850197628458498
NEG_at_1_jaccard:  0.5353096179183136
NEG_at_5_jaccard:  0.7524044795783926
NEG_at_10_jaccard:  0.8186429512516469
NEG_at_20_jaccard:  0.8436758893280633
NEG_at_50_jaccard:  0.8725625823451911
NEG_at_100_jaccard:  0.9300065876152833
0.6320210024793806 0.785546004916486 0.503555091304339 0.2812582345191041 0.5353096179183136 0.5190711462450593 0.7524044795783926 0.6234189723320158 0.8186429512516469 0.6878458498023715 0.8436758893280633 0.7649209486166008 0.8725625823451911 0.850197628458498 0.9300065876152833
 ============ Start explaining Yahoo MLP by cosine ============
From file: MLP_cosine_expl_dict.pkl
User 0, total time: 1.06
User 500, total time: 0.99
User 1000, total time: 1.07
User 1500, total time: 1.04
User 2000, total time: 1.03
User 2500, total time: 1.06
this experiment is for /home/amir.reza/counterfactual/CFX-REC/checkpoints/3MLP_Yahoo_3_256.pt and MLP
users_DEL_cosine:  0.6284286718619431
users_INS_cosine:  0.7895823238197867
NDCG_cosine:  0.49668728760216624
POS_at_1_cosine:  0.27223320158102765
POS_at_5_cosine:  0.5104743083003953
POS_at_10_cosine:  0.6181159420289855
POS_at_20_cosine:  0.6842885375494071
POS_at_50_cosine:  0.7621541501976284
POS_at_100_cosine:  0.8487812911725955
NEG_at_1_cosine:  0.533102766798419
NEG_at_5_cosine:  0.7531620553359683
NEG_at_10_cosine:  0.822364953886693
NEG_at_20_cosine:  0.8458827404479577
NEG_at_50_cosine:  0.8735507246376811
NEG_at_100_cosine:  0.930467720685112
0.6284286718619431 0.7895823238197867 0.49668728760216624 0.27223320158102765 0.533102766798419 0.5104743083003953 0.7531620553359683 0.6181159420289855 0.822364953886693 0.6842885375494071 0.8458827404479577 0.7621541501976284 0.8735507246376811 0.8487812911725955 0.930467720685112
 ============ Start explaining Yahoo MLP by shap ============
From file: MLP_shap_expl_dict.pkl
User 0, total time: 0.99
User 500, total time: 1.03
User 1000, total time: 1.04
User 1500, total time: 1.04
User 2000, total time: 1.05
User 2500, total time: 1.04
this experiment is for /home/amir.reza/counterfactual/CFX-REC/checkpoints/3MLP_Yahoo_3_256.pt and MLP
users_DEL_shap:  0.6745588893600898
users_INS_shap:  0.7591955960454292
NDCG_shap:  0.5806277997462921
POS_at_1_shap:  0.3663372859025033
POS_at_5_shap:  0.6165349143610014
POS_at_10_shap:  0.7126482213438735
POS_at_20_shap:  0.7670619235836627
POS_at_50_shap:  0.8273056653491436
POS_at_100_shap:  0.900592885375494
NEG_at_1_shap:  0.41795125164690383
NEG_at_5_shap:  0.6657114624505929
NEG_at_10_shap:  0.7576416337285902
NEG_at_20_shap:  0.7986824769433466
NEG_at_50_shap:  0.8432476943346509
NEG_at_100_shap:  0.9106719367588932
0.6745588893600898 0.7591955960454292 0.5806277997462921 0.3663372859025033 0.41795125164690383 0.6165349143610014 0.6657114624505929 0.7126482213438735 0.7576416337285902 0.7670619235836627 0.7986824769433466 0.8273056653491436 0.8432476943346509 0.900592885375494 0.9106719367588932
 ============ Start explaining Yahoo MLP by accent ============
From file: MLP_accent_expl_dict.pkl
User 0, total time: 1.05
User 500, total time: 1.41
User 1000, total time: 1.02
User 1500, total time: 1.05
User 2000, total time: 1.02
User 2500, total time: 1.00
this experiment is for /home/amir.reza/counterfactual/CFX-REC/checkpoints/3MLP_Yahoo_3_256.pt and MLP
users_DEL_accent:  0.5702524354339
users_INS_accent:  0.8068213225623326
NDCG_accent:  0.45947270253047406
POS_at_1_accent:  0.2559947299077734
POS_at_5_accent:  0.4414361001317523
POS_at_10_accent:  0.5363965744400527
POS_at_20_accent:  0.6000329380764163
POS_at_50_accent:  0.6926218708827405
POS_at_100_accent:  0.7929183135704875
NEG_at_1_accent:  0.42658102766798417
NEG_at_5_accent:  0.7100790513833992
NEG_at_10_accent:  0.8001646903820817
NEG_at_20_accent:  0.8373517786561264
NEG_at_50_accent:  0.8706192358366271
NEG_at_100_accent:  0.9278656126482214
0.5702524354339 0.8068213225623326 0.45947270253047406 0.2559947299077734 0.42658102766798417 0.4414361001317523 0.7100790513833992 0.5363965744400527 0.8001646903820817 0.6000329380764163 0.8373517786561264 0.6926218708827405 0.8706192358366271 0.7929183135704875 0.9278656126482214
