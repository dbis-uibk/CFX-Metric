/home/amir.reza/counterfactual/CFX-REC/code/recommenders_architecture.py:41: UserWarning: The use of `x.T` on tensors of dimension other than 2 to reverse their shape is deprecated and it will throw an error in a future release. Consider `x.mT` to transpose batches of matrices or `x.permute(*torch.arange(x.ndim - 1, -1, -1))` to reverse the dimensions of a tensor. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3675.)
  output = torch.matmul(user_vec, item_vec.T).to(self.device)
0
500
1000
1500
2000
2500
 ============ Start explaining Yahoo MLP by lxr ============
From file: MLP_lxr_expl_dict.pkl
User 0, total time: 1.08
User 500, total time: 1.06
User 1000, total time: 1.47
User 1500, total time: 1.04
User 2000, total time: 1.09
User 2500, total time: 1.09
this experiment is for /home/amir.reza/counterfactual/CFX-REC/checkpoints/5MLP_Yahoo_5_256.pt and MLP
users_DEL_lxr:  0.5620415712713283
users_INS_lxr:  0.8618932867714735
NDCG_lxr:  0.45909133623593407
POS_at_1_lxr:  0.30256916996047434
POS_at_5_lxr:  0.4314888010540185
POS_at_10_lxr:  0.47190382081686433
POS_at_20_lxr:  0.5124505928853754
POS_at_50_lxr:  0.5689723320158102
POS_at_100_lxr:  0.6267127799736495
NEG_at_1_lxr:  0.5710803689064559
NEG_at_5_lxr:  0.7605731225296443
NEG_at_10_lxr:  0.7929183135704875
NEG_at_20_lxr:  0.8174242424242424
NEG_at_50_lxr:  0.8455533596837944
NEG_at_100_lxr:  0.8702898550724638
0.5620415712713283 0.8618932867714735 0.45909133623593407 0.30256916996047434 0.5710803689064559 0.4314888010540185 0.7605731225296443 0.47190382081686433 0.7929183135704875 0.5124505928853754 0.8174242424242424 0.5689723320158102 0.8455533596837944 0.6267127799736495 0.8702898550724638
 ============ Start explaining Yahoo MLP by lime ============
From file: MLP_lime_expl_dict.pkl
User 0, total time: 1.03
User 500, total time: 1.06
User 1000, total time: 1.07
User 1500, total time: 1.07
User 2000, total time: 1.05
User 2500, total time: 1.00
this experiment is for /home/amir.reza/counterfactual/CFX-REC/checkpoints/5MLP_Yahoo_5_256.pt and MLP
users_DEL_lime:  0.624649533729795
users_INS_lime:  0.8578916376059057
NDCG_lime:  0.49357296262005146
POS_at_1_lime:  0.3248353096179183
POS_at_5_lime:  0.47681159420289854
POS_at_10_lime:  0.527733860342556
POS_at_20_lime:  0.5758563899868248
POS_at_50_lime:  0.6429512516469038
POS_at_100_lime:  0.7042490118577075
NEG_at_1_lime:  0.6086297760210804
NEG_at_5_lime:  0.7800395256916997
NEG_at_10_lime:  0.8073451910408432
NEG_at_20_lime:  0.8280961791831357
NEG_at_50_lime:  0.8543148880105402
NEG_at_100_lime:  0.8775362318840579
0.624649533729795 0.8578916376059057 0.49357296262005146 0.3248353096179183 0.6086297760210804 0.47681159420289854 0.7800395256916997 0.527733860342556 0.8073451910408432 0.5758563899868248 0.8280961791831357 0.6429512516469038 0.8543148880105402 0.7042490118577075 0.8775362318840579
 ============ Start explaining Yahoo MLP by jaccard ============
From file: MLP_jaccard_expl_dict.pkl
User 0, total time: 1.01
User 500, total time: 1.33
User 1000, total time: 1.05
User 1500, total time: 1.32
User 2000, total time: 1.05
User 2500, total time: 1.05
this experiment is for /home/amir.reza/counterfactual/CFX-REC/checkpoints/5MLP_Yahoo_5_256.pt and MLP
users_DEL_jaccard:  0.6374762390773053
users_INS_jaccard:  0.8494042566556568
NDCG_jaccard:  0.48353813796479633
POS_at_1_jaccard:  0.3153491436100132
POS_at_5_jaccard:  0.4632411067193676
POS_at_10_jaccard:  0.5126811594202898
POS_at_20_jaccard:  0.55899209486166
POS_at_50_jaccard:  0.6262845849802371
POS_at_100_jaccard:  0.6881752305665348
NEG_at_1_jaccard:  0.5745718050065876
NEG_at_5_jaccard:  0.7597167325428196
NEG_at_10_jaccard:  0.7955533596837944
NEG_at_20_jaccard:  0.8216073781291172
NEG_at_50_jaccard:  0.8525032938076417
NEG_at_100_jaccard:  0.8773056653491437
0.6374762390773053 0.8494042566556568 0.48353813796479633 0.3153491436100132 0.5745718050065876 0.4632411067193676 0.7597167325428196 0.5126811594202898 0.7955533596837944 0.55899209486166 0.8216073781291172 0.6262845849802371 0.8525032938076417 0.6881752305665348 0.8773056653491437
 ============ Start explaining Yahoo MLP by cosine ============
From file: MLP_cosine_expl_dict.pkl
User 0, total time: 1.03
User 500, total time: 1.03
User 1000, total time: 1.04
User 1500, total time: 1.06
User 2000, total time: 1.06
User 2500, total time: 1.03
this experiment is for /home/amir.reza/counterfactual/CFX-REC/checkpoints/5MLP_Yahoo_5_256.pt and MLP
users_DEL_cosine:  0.6344721960461837
users_INS_cosine:  0.8529396611738248
NDCG_cosine:  0.48023354597193374
POS_at_1_cosine:  0.3127470355731225
POS_at_5_cosine:  0.4573122529644269
POS_at_10_cosine:  0.5072793148880105
POS_at_20_cosine:  0.5553030303030303
POS_at_50_cosine:  0.6242753623188406
POS_at_100_cosine:  0.6869565217391305
NEG_at_1_cosine:  0.5783926218708827
NEG_at_5_cosine:  0.7668313570487484
NEG_at_10_cosine:  0.8009222661396574
NEG_at_20_cosine:  0.827140974967062
NEG_at_50_cosine:  0.8560276679841897
NEG_at_100_cosine:  0.8793478260869565
0.6344721960461837 0.8529396611738248 0.48023354597193374 0.3127470355731225 0.5783926218708827 0.4573122529644269 0.7668313570487484 0.5072793148880105 0.8009222661396574 0.5553030303030303 0.827140974967062 0.6242753623188406 0.8560276679841897 0.6869565217391305 0.8793478260869565
 ============ Start explaining Yahoo MLP by shap ============
From file: MLP_shap_expl_dict.pkl
User 0, total time: 1.29
User 500, total time: 1.05
User 1000, total time: 1.31
User 1500, total time: 1.00
User 2000, total time: 1.39
User 2500, total time: 1.06
this experiment is for /home/amir.reza/counterfactual/CFX-REC/checkpoints/5MLP_Yahoo_5_256.pt and MLP
users_DEL_shap:  0.7294263548398395
users_INS_shap:  0.7910757800324744
NDCG_shap:  0.6013461747846035
POS_at_1_shap:  0.43221343873517787
POS_at_5_shap:  0.6180830039525692
POS_at_10_shap:  0.6662714097496707
POS_at_20_shap:  0.7069828722002635
POS_at_50_shap:  0.7622859025032939
POS_at_100_shap:  0.8073122529644268
NEG_at_1_shap:  0.4330368906455863
NEG_at_5_shap:  0.61699604743083
NEG_at_10_shap:  0.6632081686429513
NEG_at_20_shap:  0.7051383399209487
NEG_at_50_shap:  0.7616271409749671
NEG_at_100_shap:  0.8064888010540184
0.7294263548398395 0.7910757800324744 0.6013461747846035 0.43221343873517787 0.4330368906455863 0.6180830039525692 0.61699604743083 0.6662714097496707 0.6632081686429513 0.7069828722002635 0.7051383399209487 0.7622859025032939 0.7616271409749671 0.8073122529644268 0.8064888010540184
 ============ Start explaining Yahoo MLP by accent ============
From file: MLP_accent_expl_dict.pkl
User 0, total time: 1.04
User 500, total time: 0.98
User 1000, total time: 1.06
User 1500, total time: 1.05
User 2000, total time: 0.98
User 2500, total time: 1.01
this experiment is for /home/amir.reza/counterfactual/CFX-REC/checkpoints/5MLP_Yahoo_5_256.pt and MLP
users_DEL_accent:  0.5678887280424928
users_INS_accent:  0.8645931835765172
NDCG_accent:  0.4801108930436636
POS_at_1_accent:  0.32733860342556
POS_at_5_accent:  0.4534584980237154
POS_at_10_accent:  0.4910079051383399
POS_at_20_accent:  0.5304018445322793
POS_at_50_accent:  0.5889328063241107
POS_at_100_accent:  0.6456521739130435
NEG_at_1_accent:  0.46581027667984193
NEG_at_5_accent:  0.6920289855072463
NEG_at_10_accent:  0.7489459815546772
NEG_at_20_accent:  0.7923254281949935
NEG_at_50_accent:  0.8347496706192359
NEG_at_100_accent:  0.8654479578392621
0.5678887280424928 0.8645931835765172 0.4801108930436636 0.32733860342556 0.46581027667984193 0.4534584980237154 0.6920289855072463 0.4910079051383399 0.7489459815546772 0.5304018445322793 0.7923254281949935 0.5889328063241107 0.8347496706192359 0.6456521739130435 0.8654479578392621
