======================== new run - MLP ========================
train pos_loss = 0.4340082434090701, neg_loss = 0.14951018040830438
this model is saved as MLP_Yahoo_0_128.pt
test pos_loss = 0.6378264427185059, neg_loss = 0.07098597288131714
hit_at_10 is 6, hit_at_50 is 24, hit_at_100 is 33
0.002173913043478261 0.008695652173913044 0.011956521739130435 0.0 76.32891688386904
train pos_loss = 0.7116963592442599, neg_loss = 0.04680237952958454
this model is saved as MLP_Yahoo_1_128.pt
test pos_loss = 0.6803727149963379, neg_loss = 0.054746560752391815
hit_at_10 is 75, hit_at_50 is 193, hit_at_100 is 240
0.02717391304347826 0.06992753623188405 0.08695652173913043 0.010144927536231883 58.24149447865118
train pos_loss = 0.6433092030611905, neg_loss = 0.05803556977347894
this model is saved as MLP_Yahoo_2_128.pt
test pos_loss = 0.5481843948364258, neg_loss = 0.0829501822590828
hit_at_10 is 169, hit_at_50 is 423, hit_at_100 is 531
0.06123188405797102 0.1532608695652174 0.1923913043478261 0.002536231884057971 43.00113952580603
train pos_loss = 0.5133479074998335, neg_loss = 0.07968175885352222
this model is saved as MLP_Yahoo_3_128.pt
test pos_loss = 0.46677857637405396, neg_loss = 0.08866436034440994
hit_at_10 is 199, hit_at_50 is 561, hit_at_100 is 740
0.07210144927536231 0.20326086956521738 0.26811594202898553 0.009420289855072464 30.053568730404535
train pos_loss = 0.45314294370737945, neg_loss = 0.0758398480036042
this model is saved as MLP_Yahoo_4_128.pt
test pos_loss = 0.4562247395515442, neg_loss = 0.07485682517290115
hit_at_10 is 369, hit_at_50 is 767, hit_at_100 is 989
0.13369565217391305 0.2778985507246377 0.35833333333333334 0.02391304347826087 23.830301942860018
train pos_loss = 0.4292469756169753, neg_loss = 0.06736047938466072
this model is saved as MLP_Yahoo_5_128.pt
test pos_loss = 0.4229331314563751, neg_loss = 0.07186684757471085
hit_at_10 is 440, hit_at_50 is 917, hit_at_100 is 1145
0.15942028985507245 0.3322463768115942 0.4148550724637681 0.04384057971014493 20.075265364711274
train pos_loss = 0.40084637836976483, neg_loss = 0.06390459158203819
this model is saved as MLP_Yahoo_6_128.pt
test pos_loss = 0.402517706155777, neg_loss = 0.07011283934116364
hit_at_10 is 468, hit_at_50 is 975, hit_at_100 is 1216
0.16956521739130434 0.3532608695652174 0.4405797101449275 0.05144927536231884 17.8583289263275
train pos_loss = 0.38954476334831933, neg_loss = 0.05727043578570539
this model is saved as MLP_Yahoo_7_128.pt
test pos_loss = 0.3970535397529602, neg_loss = 0.06558406352996826
hit_at_10 is 521, hit_at_50 is 1029, hit_at_100 is 1272
0.188768115942029 0.37282608695652175 0.4608695652173913 0.05036231884057971 16.449125838905115
train pos_loss = 0.3667534969069741, neg_loss = 0.05826467851346189
this model is saved as MLP_Yahoo_8_128.pt
test pos_loss = 0.39927783608436584, neg_loss = 0.059812914580106735
hit_at_10 is 497, hit_at_50 is 1017, hit_at_100 is 1277
0.18007246376811595 0.3684782608695652 0.46268115942028987 0.04927536231884058 15.227181153124631
train pos_loss = 0.34305132790045306, neg_loss = 0.057401212778958405
this model is saved as MLP_Yahoo_9_128.pt
test pos_loss = 0.4079553186893463, neg_loss = 0.05485329031944275
hit_at_10 is 481, hit_at_50 is 993, hit_at_100 is 1263
0.17427536231884058 0.35978260869565215 0.45760869565217394 0.042753623188405795 14.557804177841604
======================== new run - MLP ========================
train pos_loss = 0.28138502551750705, neg_loss = 0.16930456391789697
this model is saved as MLP_Yahoo_0_256.pt
test pos_loss = 0.2538849413394928, neg_loss = 0.15109843015670776
hit_at_10 is 579, hit_at_50 is 1162, hit_at_100 is 1432
0.20978260869565218 0.4210144927536232 0.518840579710145 0.05144927536231884 18.14043239023412
train pos_loss = 0.21276710385626013, neg_loss = 0.1289442079988393
this model is saved as MLP_Yahoo_1_256.pt
test pos_loss = 0.27426961064338684, neg_loss = 0.11366908997297287
hit_at_10 is 532, hit_at_50 is 1107, hit_at_100 is 1388
0.1927536231884058 0.40108695652173915 0.5028985507246376 0.05217391304347826 15.25828202319352
train pos_loss = 0.17922808636318555, neg_loss = 0.11708988757296042
this model is saved as MLP_Yahoo_2_256.pt
test pos_loss = 0.26009321212768555, neg_loss = 0.1129051074385643
hit_at_10 is 485, hit_at_50 is 1016, hit_at_100 is 1325
0.17572463768115942 0.3681159420289855 0.48007246376811596 0.04565217391304348 15.11750966393437
train pos_loss = 0.17278947681188583, neg_loss = 0.10387277332219211
this model is saved as MLP_Yahoo_3_256.pt
test pos_loss = 0.29081177711486816, neg_loss = 0.09719115495681763
hit_at_10 is 450, hit_at_50 is 910, hit_at_100 is 1174
0.16304347826086957 0.32971014492753625 0.42536231884057973 0.03369565217391304 15.211725153930482
train pos_loss = 0.15169797973199325, neg_loss = 0.09588326208970764
this model is saved as MLP_Yahoo_4_256.pt
test pos_loss = 0.2723199129104614, neg_loss = 0.10617458075284958
hit_at_10 is 475, hit_at_50 is 951, hit_at_100 is 1208
0.1721014492753623 0.34456521739130436 0.43768115942028984 0.034782608695652174 15.141110754353528
train pos_loss = 0.15024277093735608, neg_loss = 0.08843476223674687
this model is saved as MLP_Yahoo_5_256.pt
test pos_loss = 0.32787173986434937, neg_loss = 0.08004865050315857
hit_at_10 is 407, hit_at_50 is 835, hit_at_100 is 1103
0.14746376811594203 0.302536231884058 0.3996376811594203 0.0322463768115942 17.01443451818839
train pos_loss = 0.13375963609326968, neg_loss = 0.08124213123863394
this model is saved as MLP_Yahoo_6_256.pt
test pos_loss = 0.3505015969276428, neg_loss = 0.08045699447393417
hit_at_10 is 402, hit_at_50 is 835, hit_at_100 is 1086
0.14565217391304347 0.302536231884058 0.3934782608695652 0.029710144927536233 17.282805436986134
train pos_loss = 0.12751742994243448, neg_loss = 0.08007980307394807
this model is saved as MLP_Yahoo_7_256.pt
test pos_loss = 0.3808939754962921, neg_loss = 0.0672186017036438
hit_at_10 is 360, hit_at_50 is 800, hit_at_100 is 1049
0.13043478260869565 0.2898550724637681 0.38007246376811593 0.02789855072463768 17.15977127639486
======================== new run - MLP ========================
train pos_loss = 0.6993369256908243, neg_loss = 0.06599827432496981
this model is saved as MLP_Yahoo_0_256.pt
test pos_loss = 0.8286417722702026, neg_loss = 0.024011481553316116
hit_at_10 is 76, hit_at_50 is 322, hit_at_100 is 408
0.02753623188405797 0.11666666666666667 0.14782608695652175 0.00036231884057971015 55.9426270791624
train pos_loss = 0.8423742814497515, neg_loss = 0.017395505935631016
this model is saved as MLP_Yahoo_1_256.pt
test pos_loss = 0.8023818731307983, neg_loss = 0.02207360789179802
hit_at_10 is 57, hit_at_50 is 247, hit_at_100 is 502
0.020652173913043477 0.08949275362318841 0.18188405797101448 0.00036231884057971015 45.38313407371039
train pos_loss = 0.7421417886560614, neg_loss = 0.026516445997086437
this model is saved as MLP_Yahoo_2_256.pt
test pos_loss = 0.6833494901657104, neg_loss = 0.04199673607945442
hit_at_10 is 154, hit_at_50 is 451, hit_at_100 is 659
0.05579710144927536 0.16340579710144928 0.23876811594202899 0.011594202898550725 36.40991922587796
train pos_loss = 0.5983528711579063, neg_loss = 0.0407103645530614
this model is saved as MLP_Yahoo_3_256.pt
test pos_loss = 0.5900202989578247, neg_loss = 0.04305817931890488
hit_at_10 is 289, hit_at_50 is 650, hit_at_100 is 896
0.10471014492753623 0.23550724637681159 0.32463768115942027 0.019927536231884056 26.365904254649486
train pos_loss = 0.5052350813692267, neg_loss = 0.04072083905339241
this model is saved as MLP_Yahoo_4_256.pt
test pos_loss = 0.5388854742050171, neg_loss = 0.04634292796254158
hit_at_10 is 317, hit_at_50 is 744, hit_at_100 is 1020
0.11485507246376811 0.26956521739130435 0.3695652173913043 0.017028985507246377 19.861604276054877
train pos_loss = 0.41110316731713037, neg_loss = 0.05100174451416189
this model is saved as MLP_Yahoo_5_256.pt
test pos_loss = 0.4744528830051422, neg_loss = 0.05818220600485802
hit_at_10 is 328, hit_at_50 is 771, hit_at_100 is 1061
0.11884057971014493 0.2793478260869565 0.3844202898550725 0.02789855072463768 17.73617616691219
train pos_loss = 0.3730960054831071, neg_loss = 0.04718738862059333
this model is saved as MLP_Yahoo_6_256.pt
test pos_loss = 0.4571397304534912, neg_loss = 0.057281848043203354
hit_at_10 is 318, hit_at_50 is 754, hit_at_100 is 1049
0.11521739130434783 0.27318840579710146 0.38007246376811593 0.02246376811594203 16.826357672597265
train pos_loss = 0.33673626997254114, neg_loss = 0.04701819135384126
this model is saved as MLP_Yahoo_7_256.pt
test pos_loss = 0.48195216059684753, neg_loss = 0.04760725423693657
hit_at_10 is 277, hit_at_50 is 711, hit_at_100 is 980
0.10036231884057971 0.2576086956521739 0.35507246376811596 0.016304347826086956 15.462656920887971
train pos_loss = 0.32780007882551715, neg_loss = 0.04169638217850165
this model is saved as MLP_Yahoo_8_256.pt
test pos_loss = 0.5208780765533447, neg_loss = 0.04080958291888237
hit_at_10 is 271, hit_at_50 is 690, hit_at_100 is 971
0.09818840579710145 0.25 0.35181159420289854 0.017753623188405798 15.685242196451725
Best hyperparameters: {'learning_rate': 0.006091616582578328, 'batch_size': 512, 'hidden_dim': 256, 'beta': 1.5056943452764542}
Best metric value: 0.20978260869565218
Traceback (most recent call last):
  File "/home/amir.reza/counterfactual/CFX-REC/code/init_recommenders_training.py", line 361, in <module>
    model = load_recommender()
  File "/home/amir.reza/counterfactual/CFX-REC/code/init_recommenders_training.py", line 354, in load_recommender
    recommender_checkpoint = torch.load(Path(checkpoints_path, recommender_path))
  File "/home/amir.reza/counterfactual/CFX-REC/cfx-recVenv/lib/python3.10/site-packages/torch/serialization.py", line 997, in load
    with _open_file_like(f, 'rb') as opened_file:
  File "/home/amir.reza/counterfactual/CFX-REC/cfx-recVenv/lib/python3.10/site-packages/torch/serialization.py", line 444, in _open_file_like
    return _open_file(name_or_buffer, mode)
  File "/home/amir.reza/counterfactual/CFX-REC/cfx-recVenv/lib/python3.10/site-packages/torch/serialization.py", line 425, in __init__
    super().__init__(open(name, mode))
FileNotFoundError: [Errno 2] No such file or directory: '/home/amir.reza/counterfactual/CFX-REC/checkpoints/MLP2_Yahoo_0.0083_128_1.pt'
srun: error: gc15: task 0: Exited with exit code 1
