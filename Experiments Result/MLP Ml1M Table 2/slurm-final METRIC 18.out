/home/amir.reza/counterfactual/CFX-REC/code/recommenders_architecture.py:41: UserWarning: The use of `x.T` on tensors of dimension other than 2 to reverse their shape is deprecated and it will throw an error in a future release. Consider `x.mT` to transpose batches of matrices or `x.permute(*torch.arange(x.ndim - 1, -1, -1))` to reverse the dimensions of a tensor. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3675.)
  output = torch.matmul(user_vec, item_vec.T).to(self.device)
0
500
1000
 ============ Start explaining ML1M MLP by lxr ============
From file: MLP_lxr_expl_dict.pkl
User 0, total time: 0.99
User 500, total time: 1.28
User 1000, total time: 0.92
this experiment is for /home/amir.reza/counterfactual/CFX-REC/checkpoints/MLP_ML1M_18_512.pt and MLP
users_DEL_lxr:  0.6880347378652294
users_INS_lxr:  0.8249424705668736
NDCG_lxr:  0.5140123389401148
POS_at_1_lxr:  0.3213425647200482
POS_at_5_lxr:  0.5154274533413606
POS_at_10_lxr:  0.5894039735099338
POS_at_20_lxr:  0.6502859723058398
POS_at_50_lxr:  0.7326158940397351
POS_at_100_lxr:  0.7830373269114991
NEG_at_1_lxr:  0.40434978928356413
NEG_at_5_lxr:  0.6508880192655027
NEG_at_10_lxr:  0.7344220349187236
NEG_at_20_lxr:  0.7957555689343768
NEG_at_50_lxr:  0.8613786875376279
NEG_at_100_lxr:  0.8932871763997591
0.6880347378652294 0.8249424705668736 0.5140123389401148 0.3213425647200482 0.40434978928356413 0.5154274533413606 0.6508880192655027 0.5894039735099338 0.7344220349187236 0.6502859723058398 0.7957555689343768 0.7326158940397351 0.8613786875376279 0.7830373269114991 0.8932871763997591
 ============ Start explaining ML1M MLP by lime ============
From file: MLP_lime_expl_dict.pkl
User 0, total time: 1.07
User 500, total time: 0.98
User 1000, total time: 1.08
this experiment is for /home/amir.reza/counterfactual/CFX-REC/checkpoints/MLP_ML1M_18_512.pt and MLP
users_DEL_lime:  0.7614030846445623
users_INS_lime:  0.8003094756896151
NDCG_lime:  0.5910082087565544
POS_at_1_lime:  0.3908037326911499
POS_at_5_lime:  0.6233443708609272
POS_at_10_lime:  0.6994280553883203
POS_at_20_lime:  0.7560204695966285
POS_at_50_lime:  0.8236754966887417
POS_at_100_lime:  0.8652167369054787
NEG_at_1_lime:  0.42203491872366045
NEG_at_5_lime:  0.6632299819385912
NEG_at_10_lime:  0.7375075255869957
NEG_at_20_lime:  0.7934226369656834
NEG_at_50_lime:  0.8529500301023479
NEG_at_100_lime:  0.8879440096327514
0.7614030846445623 0.8003094756896151 0.5910082087565544 0.3908037326911499 0.42203491872366045 0.6233443708609272 0.6632299819385912 0.6994280553883203 0.7375075255869957 0.7560204695966285 0.7934226369656834 0.8236754966887417 0.8529500301023479 0.8652167369054787 0.8879440096327514
 ============ Start explaining ML1M MLP by jaccard ============
From file: MLP_jaccard_expl_dict.pkl
User 0, total time: 1.04
User 500, total time: 0.96
User 1000, total time: 0.88
this experiment is for /home/amir.reza/counterfactual/CFX-REC/checkpoints/MLP_ML1M_18_512.pt and MLP
users_DEL_jaccard:  0.7390879984506014
users_INS_jaccard:  0.7968656984552803
NDCG_jaccard:  0.493326628904774
POS_at_1_jaccard:  0.29996989765201687
POS_at_5_jaccard:  0.48841059602649006
POS_at_10_jaccard:  0.5632149307645996
POS_at_20_jaccard:  0.6284617700180614
POS_at_50_jaccard:  0.7103401565322095
POS_at_100_jaccard:  0.767308850090307
NEG_at_1_jaccard:  0.3824503311258278
NEG_at_5_jaccard:  0.6079921733895244
NEG_at_10_jaccard:  0.6848284166164961
NEG_at_20_jaccard:  0.7501505117399156
NEG_at_50_jaccard:  0.8232239614689946
NEG_at_100_jaccard:  0.8663455749548464
0.7390879984506014 0.7968656984552803 0.493326628904774 0.29996989765201687 0.3824503311258278 0.48841059602649006 0.6079921733895244 0.5632149307645996 0.6848284166164961 0.6284617700180614 0.7501505117399156 0.7103401565322095 0.8232239614689946 0.767308850090307 0.8663455749548464
 ============ Start explaining ML1M MLP by cosine ============
From file: MLP_cosine_expl_dict.pkl
User 0, total time: 1.28
User 500, total time: 1.02
User 1000, total time: 0.92
this experiment is for /home/amir.reza/counterfactual/CFX-REC/checkpoints/MLP_ML1M_18_512.pt and MLP
users_DEL_cosine:  0.7386691530436192
users_INS_cosine:  0.7961307010405713
NDCG_cosine:  0.4889751786662155
POS_at_1_cosine:  0.29462673088500907
POS_at_5_cosine:  0.48427152317880795
POS_at_10_cosine:  0.5559151113786875
POS_at_20_cosine:  0.6210114388922335
POS_at_50_cosine:  0.7025135460565924
POS_at_100_cosine:  0.7636213124623721
NEG_at_1_cosine:  0.38237507525587
NEG_at_5_cosine:  0.6061107766405779
NEG_at_10_cosine:  0.6813666465984347
NEG_at_20_cosine:  0.7460866947621915
NEG_at_50_cosine:  0.8206652618904274
NEG_at_100_cosine:  0.8633353401565322
0.7386691530436192 0.7961307010405713 0.4889751786662155 0.29462673088500907 0.38237507525587 0.48427152317880795 0.6061107766405779 0.5559151113786875 0.6813666465984347 0.6210114388922335 0.7460866947621915 0.7025135460565924 0.8206652618904274 0.7636213124623721 0.8633353401565322
 ============ Start explaining ML1M MLP by shap ============
From file: MLP_shap_expl_dict.pkl
User 0, total time: 0.91
User 500, total time: 1.02
User 1000, total time: 0.88
this experiment is for /home/amir.reza/counterfactual/CFX-REC/checkpoints/MLP_ML1M_18_512.pt and MLP
users_DEL_shap:  0.7649862309181888
users_INS_shap:  0.7893500741849295
NDCG_shap:  0.5633917154429154
POS_at_1_shap:  0.36484045755568933
POS_at_5_shap:  0.5832329921733895
POS_at_10_shap:  0.6616496086694762
POS_at_20_shap:  0.7282510535821795
POS_at_50_shap:  0.8015502709211318
POS_at_100_shap:  0.8476068633353401
NEG_at_1_shap:  0.3793648404575557
NEG_at_5_shap:  0.6028747742323901
NEG_at_10_shap:  0.6794852498494883
NEG_at_20_shap:  0.7368302227573751
NEG_at_50_shap:  0.8044099939795304
NEG_at_100_shap:  0.8485851896447922
0.7649862309181888 0.7893500741849295 0.5633917154429154 0.36484045755568933 0.3793648404575557 0.5832329921733895 0.6028747742323901 0.6616496086694762 0.6794852498494883 0.7282510535821795 0.7368302227573751 0.8015502709211318 0.8044099939795304 0.8476068633353401 0.8485851896447922
 ============ Start explaining ML1M MLP by accent ============
From file: MLP_accent_expl_dict.pkl
User 0, total time: 0.94
User 500, total time: 0.95
User 1000, total time: 0.89
this experiment is for /home/amir.reza/counterfactual/CFX-REC/checkpoints/MLP_ML1M_18_512.pt and MLP
users_DEL_accent:  0.7410791295135931
users_INS_accent:  0.8001334164949392
NDCG_accent:  0.5080378432514248
POS_at_1_accent:  0.31268813967489467
POS_at_5_accent:  0.5092564720048164
POS_at_10_accent:  0.5853401565322095
POS_at_20_accent:  0.6557796508127633
POS_at_50_accent:  0.73524984948826
POS_at_100_accent:  0.7907886815171583
NEG_at_1_accent:  0.38711619506321493
NEG_at_5_accent:  0.609271523178808
NEG_at_10_accent:  0.6881396748946418
NEG_at_20_accent:  0.7459361830222757
NEG_at_50_accent:  0.8186333534015653
NEG_at_100_accent:  0.8604756170981337
0.7410791295135931 0.8001334164949392 0.5080378432514248 0.31268813967489467 0.38711619506321493 0.5092564720048164 0.609271523178808 0.5853401565322095 0.6881396748946418 0.6557796508127633 0.7459361830222757 0.73524984948826 0.8186333534015653 0.7907886815171583 0.8604756170981337
