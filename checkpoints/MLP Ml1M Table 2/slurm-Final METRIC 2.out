/home/amir.reza/counterfactual/CFX-REC/code/recommenders_architecture.py:41: UserWarning: The use of `x.T` on tensors of dimension other than 2 to reverse their shape is deprecated and it will throw an error in a future release. Consider `x.mT` to transpose batches of matrices or `x.permute(*torch.arange(x.ndim - 1, -1, -1))` to reverse the dimensions of a tensor. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3675.)
  output = torch.matmul(user_vec, item_vec.T).to(self.device)
0
500
1000
 ============ Start explaining ML1M MLP by lxr ============
From file: MLP_lxr_expl_dict.pkl
User 0, total time: 1.07
User 500, total time: 0.94
User 1000, total time: 0.98
this experiment is for /home/amir.reza/counterfactual/CFX-REC/checkpoints/MLP_ML1M_2_512.pt and MLP
users_DEL_lxr:  0.5834455193036664
users_INS_lxr:  0.6809159533783999
NDCG_lxr:  0.5546374223825804
POS_at_1_lxr:  0.3850090307043949
POS_at_5_lxr:  0.5760084286574353
POS_at_10_lxr:  0.6283865141481035
POS_at_20_lxr:  0.6660897049969897
POS_at_50_lxr:  0.7065773630343166
POS_at_100_lxr:  0.7324653822998194
NEG_at_1_lxr:  0.5457555689343768
NEG_at_5_lxr:  0.8231487055990367
NEG_at_10_lxr:  0.8906532209512342
NEG_at_20_lxr:  0.9273780854906682
NEG_at_50_lxr:  0.9610174593618303
NEG_at_100_lxr:  0.9775737507525588
0.5834455193036664 0.6809159533783999 0.5546374223825804 0.3850090307043949 0.5457555689343768 0.5760084286574353 0.8231487055990367 0.6283865141481035 0.8906532209512342 0.6660897049969897 0.9273780854906682 0.7065773630343166 0.9610174593618303 0.7324653822998194 0.9775737507525588
 ============ Start explaining ML1M MLP by lime ============
From file: MLP_lime_expl_dict.pkl
User 0, total time: 0.96
User 500, total time: 0.91
User 1000, total time: 0.92
this experiment is for /home/amir.reza/counterfactual/CFX-REC/checkpoints/MLP_ML1M_2_512.pt and MLP
users_DEL_lime:  0.6044551921937746
users_INS_lime:  0.6731535137744821
NDCG_lime:  0.628512632176908
POS_at_1_lime:  0.4024683925346177
POS_at_5_lime:  0.7004063816977725
POS_at_10_lime:  0.7819837447320891
POS_at_20_lime:  0.8424894641782059
POS_at_50_lime:  0.8941902468392535
POS_at_100_lime:  0.9224111980734497
NEG_at_1_lime:  0.7603100541842264
NEG_at_5_lime:  0.9358819987959061
NEG_at_10_lime:  0.9628236002408187
NEG_at_20_lime:  0.9751655629139073
NEG_at_50_lime:  0.9864539434075859
NEG_at_100_lime:  0.9912703190848886
0.6044551921937746 0.6731535137744821 0.628512632176908 0.4024683925346177 0.7603100541842264 0.7004063816977725 0.9358819987959061 0.7819837447320891 0.9628236002408187 0.8424894641782059 0.9751655629139073 0.8941902468392535 0.9864539434075859 0.9224111980734497 0.9912703190848886
 ============ Start explaining ML1M MLP by jaccard ============
From file: MLP_jaccard_expl_dict.pkl
User 0, total time: 0.93
User 500, total time: 0.94
User 1000, total time: 0.92
this experiment is for /home/amir.reza/counterfactual/CFX-REC/checkpoints/MLP_ML1M_2_512.pt and MLP
users_DEL_jaccard:  0.6005023535473349
users_INS_jaccard:  0.6768530181226137
NDCG_jaccard:  0.5984746271291325
POS_at_1_jaccard:  0.36378687537627935
POS_at_5_jaccard:  0.6611228175797712
POS_at_10_jaccard:  0.7559452137266707
POS_at_20_jaccard:  0.8245785671282361
POS_at_50_jaccard:  0.8865141481035521
POS_at_100_jaccard:  0.9221101745936183
NEG_at_1_jaccard:  0.6887417218543046
NEG_at_5_jaccard:  0.9028446718844071
NEG_at_10_jaccard:  0.9432570740517761
NEG_at_20_jaccard:  0.9628236002408187
NEG_at_50_jaccard:  0.9805087296809152
NEG_at_100_jaccard:  0.9881848284166165
0.6005023535473349 0.6768530181226137 0.5984746271291325 0.36378687537627935 0.6887417218543046 0.6611228175797712 0.9028446718844071 0.7559452137266707 0.9432570740517761 0.8245785671282361 0.9628236002408187 0.8865141481035521 0.9805087296809152 0.9221101745936183 0.9881848284166165
 ============ Start explaining ML1M MLP by cosine ============
From file: MLP_cosine_expl_dict.pkl
User 0, total time: 0.93
User 500, total time: 0.93
User 1000, total time: 1.29
this experiment is for /home/amir.reza/counterfactual/CFX-REC/checkpoints/MLP_ML1M_2_512.pt and MLP
users_DEL_cosine:  0.5989303816017941
users_INS_cosine:  0.6780436764359654
NDCG_cosine:  0.5890745396968616
POS_at_1_cosine:  0.353476821192053
POS_at_5_cosine:  0.6514900662251656
POS_at_10_cosine:  0.7469145093317279
POS_at_20_cosine:  0.818783865141481
POS_at_50_cosine:  0.8825255869957856
POS_at_100_cosine:  0.9177453341360627
NEG_at_1_cosine:  0.7058248043347382
NEG_at_5_cosine:  0.9084888621312462
NEG_at_10_cosine:  0.9452889825406382
NEG_at_20_cosine:  0.964328717639976
NEG_at_50_cosine:  0.9808850090307044
NEG_at_100_cosine:  0.9884105960264901
0.5989303816017941 0.6780436764359654 0.5890745396968616 0.353476821192053 0.7058248043347382 0.6514900662251656 0.9084888621312462 0.7469145093317279 0.9452889825406382 0.818783865141481 0.964328717639976 0.8825255869957856 0.9808850090307044 0.9177453341360627 0.9884105960264901
 ============ Start explaining ML1M MLP by shap ============
From file: MLP_shap_expl_dict.pkl
User 0, total time: 0.92
User 500, total time: 0.88
User 1000, total time: 0.97
this experiment is for /home/amir.reza/counterfactual/CFX-REC/checkpoints/MLP_ML1M_2_512.pt and MLP
users_DEL_shap:  0.6302263915341422
users_INS_shap:  0.6516915490578307
NDCG_shap:  0.7565341451637613
POS_at_1_shap:  0.5586995785671283
POS_at_5_shap:  0.8534768211920529
POS_at_10_shap:  0.9139825406381697
POS_at_20_shap:  0.9467188440698375
POS_at_50_shap:  0.9714027694160144
POS_at_100_shap:  0.9826158940397351
NEG_at_1_shap:  0.579846478025286
NEG_at_5_shap:  0.8403822998193858
NEG_at_10_shap:  0.9051023479831426
NEG_at_20_shap:  0.9397953040337146
NEG_at_50_shap:  0.9695966285370259
NEG_at_100_shap:  0.9823901264298616
0.6302263915341422 0.6516915490578307 0.7565341451637613 0.5586995785671283 0.579846478025286 0.8534768211920529 0.8403822998193858 0.9139825406381697 0.9051023479831426 0.9467188440698375 0.9397953040337146 0.9714027694160144 0.9695966285370259 0.9826158940397351 0.9823901264298616
 ============ Start explaining ML1M MLP by accent ============
From file: MLP_accent_expl_dict.pkl
User 0, total time: 0.93
User 500, total time: 0.94
User 1000, total time: 0.93
this experiment is for /home/amir.reza/counterfactual/CFX-REC/checkpoints/MLP_ML1M_2_512.pt and MLP
users_DEL_accent:  0.5594061212064693
users_INS_accent:  0.6987737134067608
NDCG_accent:  0.4922520172014644
POS_at_1_accent:  0.3247290788681517
POS_at_5_accent:  0.4927001806140879
POS_at_10_accent:  0.5459813365442504
POS_at_20_accent:  0.5915111378687538
POS_at_50_accent:  0.6411800120409391
POS_at_100_accent:  0.6760987357013847
NEG_at_1_accent:  0.517308850090307
NEG_at_5_accent:  0.8240517760385311
NEG_at_10_accent:  0.9014148103552078
NEG_at_20_accent:  0.9383654425045154
NEG_at_50_accent:  0.9678657435279953
NEG_at_100_accent:  0.9814870559903673
0.5594061212064693 0.6987737134067608 0.4922520172014644 0.3247290788681517 0.517308850090307 0.4927001806140879 0.8240517760385311 0.5459813365442504 0.9014148103552078 0.5915111378687538 0.9383654425045154 0.6411800120409391 0.9678657435279953 0.6760987357013847 0.9814870559903673
