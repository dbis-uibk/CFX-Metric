 python code/metrics.py 
0
/home/amir.reza/counterfactual/CFX-REC/code/recommenders_architecture.py:41: UserWarning: The use of `x.T` on tensors of dimension other than 2 to reverse their shape is deprecated and it will throw an error in a future release. Consider `x.mT` to transpose batches of matrices or `x.permute(*torch.arange(x.ndim - 1, -1, -1))` to reverse the dimensions of a tensor. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3675.)
  output = torch.matmul(user_vec, item_vec.T).to(self.device)
500
1000
 ============ Start explaining ML1M MLP by lxr ============
From file: MLP_lxr_expl_dict.pkl
User 0, total time: 1.07
User 500, total time: 0.95
User 1000, total time: 0.95
this experiment is for /home/amir.reza/counterfactual/CFX-REC/checkpoints/MLP_ML1M_1_512.pt and MLP
users_DEL_lxr:  0.564021807531773
users_INS_lxr:  0.6428681623408193
NDCG_lxr:  0.4675678355358025
POS_at_1_lxr:  0.30568934376881396
POS_at_5_lxr:  0.45176098735701387
POS_at_10_lxr:  0.49804334738109574
POS_at_20_lxr:  0.5474864539434076
POS_at_50_lxr:  0.6094220349187236
POS_at_100_lxr:  0.6494581577363034
NEG_at_1_lxr:  0.44912703190848885
NEG_at_5_lxr:  0.76580373269115
NEG_at_10_lxr:  0.8451986754966887
NEG_at_20_lxr:  0.8814720048163757
NEG_at_50_lxr:  0.9080373269114992
NEG_at_100_lxr:  0.9158639373871161
0.564021807531773 0.6428681623408193 0.4675678355358025 0.30568934376881396 0.44912703190848885 0.45176098735701387 0.76580373269115 0.49804334738109574 0.8451986754966887 0.5474864539434076 0.8814720048163757 0.6094220349187236 0.9080373269114992 0.6494581577363034 0.9158639373871161
 ============ Start explaining ML1M MLP by lime ============
From file: MLP_lime_expl_dict.pkl
User 0, total time: 0.99
User 500, total time: 0.90
User 1000, total time: 1.02
this experiment is for /home/amir.reza/counterfactual/CFX-REC/checkpoints/MLP_ML1M_1_512.pt and MLP
users_DEL_lime:  0.5918788681213825
users_INS_lime:  0.6283513387706644
NDCG_lime:  0.5644924553343325
POS_at_1_lime:  0.35791691751956656
POS_at_5_lime:  0.5994130042143287
POS_at_10_lime:  0.6730885009030705
POS_at_20_lime:  0.7367549668874173
POS_at_50_lime:  0.805087296809151
POS_at_100_lime:  0.8394792293798916
NEG_at_1_lime:  0.6511137868753762
NEG_at_5_lime:  0.8456502107164359
NEG_at_10_lime:  0.8755267910897051
NEG_at_20_lime:  0.8935881998795906
NEG_at_50_lime:  0.9119506321493077
NEG_at_100_lime:  0.9177453341360627
0.5918788681213825 0.6283513387706644 0.5644924553343325 0.35791691751956656 0.6511137868753762 0.5994130042143287 0.8456502107164359 0.6730885009030705 0.8755267910897051 0.7367549668874173 0.8935881998795906 0.805087296809151 0.9119506321493077 0.8394792293798916 0.9177453341360627
 ============ Start explaining ML1M MLP by jaccard ============
From file: MLP_jaccard_expl_dict.pkl
User 0, total time: 0.91
User 500, total time: 1.04
User 1000, total time: 1.04
this experiment is for /home/amir.reza/counterfactual/CFX-REC/checkpoints/MLP_ML1M_1_512.pt and MLP
users_DEL_jaccard:  0.5976925265808769
users_INS_jaccard:  0.6234947693865569
NDCG_jaccard:  0.5446861152952646
POS_at_1_jaccard:  0.3128386514148104
POS_at_5_jaccard:  0.596628537025888
POS_at_10_jaccard:  0.6870108368452739
POS_at_20_jaccard:  0.7572245635159542
POS_at_50_jaccard:  0.8302227573750752
POS_at_100_jaccard:  0.8637868753762794
NEG_at_1_jaccard:  0.6481788079470199
NEG_at_5_jaccard:  0.8368452739313667
NEG_at_10_jaccard:  0.8599488260084286
NEG_at_20_jaccard:  0.8802679108970499
NEG_at_50_jaccard:  0.9017158338350392
NEG_at_100_jaccard:  0.910671282360024
0.5976925265808769 0.6234947693865569 0.5446861152952646 0.3128386514148104 0.6481788079470199 0.596628537025888 0.8368452739313667 0.6870108368452739 0.8599488260084286 0.7572245635159542 0.8802679108970499 0.8302227573750752 0.9017158338350392 0.8637868753762794 0.910671282360024
 ============ Start explaining ML1M MLP by cosine ============
From file: MLP_cosine_expl_dict.pkl
User 0, total time: 1.05
User 500, total time: 0.96
User 1000, total time: 0.95
this experiment is for /home/amir.reza/counterfactual/CFX-REC/checkpoints/MLP_ML1M_1_512.pt and MLP
users_DEL_cosine:  0.6052480783450324
users_INS_cosine:  0.6150403354207052
NDCG_cosine:  0.5709306347245
POS_at_1_cosine:  0.3475316074653823
POS_at_5_cosine:  0.6238711619506322
POS_at_10_cosine:  0.7043949428055388
POS_at_20_cosine:  0.7718242022877785
POS_at_50_cosine:  0.8439193257074052
POS_at_100_cosine:  0.8746237206502107
NEG_at_1_cosine:  0.5812010836845274
NEG_at_5_cosine:  0.7907134256472005
NEG_at_10_cosine:  0.829846478025286
NEG_at_20_cosine:  0.8593467790487658
NEG_at_50_cosine:  0.8878687537627935
NEG_at_100_cosine:  0.9005869957856714
0.6052480783450324 0.6150403354207052 0.5709306347245 0.3475316074653823 0.5812010836845274 0.6238711619506322 0.7907134256472005 0.7043949428055388 0.829846478025286 0.7718242022877785 0.8593467790487658 0.8439193257074052 0.8878687537627935 0.8746237206502107 0.9005869957856714
 ============ Start explaining ML1M MLP by shap ============
From file: MLP_shap_expl_dict.pkl
User 0, total time: 1.48
User 500, total time: 0.93
User 1000, total time: 1.61
this experiment is for /home/amir.reza/counterfactual/CFX-REC/checkpoints/MLP_ML1M_1_512.pt and MLP
users_DEL_shap:  0.617279275152821
users_INS_shap:  0.6026095564441822
NDCG_shap:  0.7050317611981548
POS_at_1_shap:  0.5201685731487056
POS_at_5_shap:  0.7788229981938591
POS_at_10_shap:  0.829319686935581
POS_at_20_shap:  0.8630343166767007
POS_at_50_shap:  0.8958458759783263
POS_at_100_shap:  0.9087898856110777
NEG_at_1_shap:  0.42557194461167974
NEG_at_5_shap:  0.6547260686333534
NEG_at_10_shap:  0.7238862131246238
NEG_at_20_shap:  0.7746086694762192
NEG_at_50_shap:  0.8316526189042746
NEG_at_100_shap:  0.8594220349187237
0.617279275152821 0.6026095564441822 0.7050317611981548 0.5201685731487056 0.42557194461167974 0.7788229981938591 0.6547260686333534 0.829319686935581 0.7238862131246238 0.8630343166767007 0.7746086694762192 0.8958458759783263 0.8316526189042746 0.9087898856110777 0.8594220349187237
 ============ Start explaining ML1M MLP by accent ============
From file: MLP_accent_expl_dict.pkl
User 0, total time: 0.95
User 500, total time: 0.92
User 1000, total time: 1.48
this experiment is for /home/amir.reza/counterfactual/CFX-REC/checkpoints/MLP_ML1M_1_512.pt and MLP
users_DEL_accent:  0.5458459379151464
users_INS_accent:  0.6570441385328518
NDCG_accent:  0.40431877593512655
POS_at_1_accent:  0.24239915713425647
POS_at_5_accent:  0.3650662251655629
POS_at_10_accent:  0.41661649608669477
POS_at_20_accent:  0.47155328115593015
POS_at_50_accent:  0.5524533413606262
POS_at_100_accent:  0.6031757977122215
NEG_at_1_accent:  0.29214328717639976
NEG_at_5_accent:  0.5478627332931969
NEG_at_10_accent:  0.6509632751354606
NEG_at_20_accent:  0.7509030704394943
NEG_at_50_accent:  0.8530252859723059
NEG_at_100_accent:  0.8832028898254064
0.5458459379151464 0.6570441385328518 0.40431877593512655 0.24239915713425647 0.29214328717639976 0.3650662251655629 0.5478627332931969 0.41661649608669477 0.6509632751354606 0.47155328115593015 0.7509030704394943 0.5524533413606262 0.8530252859723059 0.6031757977122215 0.8832028898254064
(cfx-recVenv) (base)